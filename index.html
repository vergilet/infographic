<html>
<head>

    <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
    <script src="https://www.amcharts.com/lib/4/core.js"></script>
    <script src="https://www.amcharts.com/lib/4/maps.js"></script>
    <script src="https://www.amcharts.com/lib/4/geodata/data/countries2.js"></script>
    <script src="https://www.amcharts.com/lib/4/themes/animated.js"></script>
</head>
<body>
<style>
    #chartdiv {
        width: 100%;
        height: 500px
    }

</style>

<!-- Chart code -->
<script>
    am4core.ready(function() {


        window.onload = function() {

            /**
             * This demo uses our own method of determining user's location
             * It is not public web service that you can use
             * You'll need to find your own. We recommend http://www.maxmind.com
             */
            jQuery.getJSON( "https://www.amcharts.com/tools/country/?v=xz6Z", function( geo ) {

                // Default map
                var defaultMap = "usaAlbersLow";

                // calculate which map to be used
                var currentMap = defaultMap;
                var title = "";
                if ( am4geodata_data_countries2[ geo.country_code ] !== undefined ) {
                    currentMap = am4geodata_data_countries2[ geo.country_code ][ "maps" ][ 0 ];

                    // add country title
                    if ( am4geodata_data_countries2[ geo.country_code ][ "country" ] ) {
                        title = am4geodata_data_countries2[ geo.country_code ][ "country" ];
                    }

                }

                // Create map instance
                var chart = am4core.create("chartdiv", am4maps.MapChart);

                chart.titles.create().text = title;

                // Set map definition
                chart.geodataSource.url = "https://www.amcharts.com/lib/4/geodata/json/" + currentMap + ".json";
                chart.geodataSource.events.on("parseended", function(ev) {
                    var data = [];
                    window.x = [];
                    for(var i = 0; i < ev.target.data.features.length; i++) {
                        data.push({
                            id: ev.target.data.features[i].id,
                            value: Math.round( Math.random() * 10000 )
                        })
                        x.push({
                            id: ev.target.data.features[i].id,
                            value: Math.round( Math.random() * 10000 )
                        })
                    }
                    console.log(x);
                    polygonSeries.data = data;
                })

                // Set projection
                chart.projection = new am4maps.projections.Mercator();

                // Create map polygon series
                var polygonSeries = chart.series.push(new am4maps.MapPolygonSeries());

                //Set min/max fill color for each area
                polygonSeries.heatRules.push({
                    property: "fill",
                    target: polygonSeries.mapPolygons.template,
                    min: chart.colors.getIndex(1).brighten(1),
                    max: chart.colors.getIndex(1).brighten(-0.3)
                });

                // Make map load polygon data (state shapes and names) from GeoJSON
                polygonSeries.useGeodata = true;

                // Set up heat legend
                let heatLegend = chart.createChild(am4maps.HeatLegend);
                heatLegend.series = polygonSeries;
                heatLegend.align = "right";
                heatLegend.width = am4core.percent(25);
                heatLegend.marginRight = am4core.percent(4);
                heatLegend.minValue = 0;
                heatLegend.maxValue = 40000000;
                heatLegend.valign = "bottom";

                // Set up custom heat map legend labels using axis ranges
                var minRange = heatLegend.valueAxis.axisRanges.create();
                minRange.value = heatLegend.minValue;
                minRange.label.text = "Little";
                var maxRange = heatLegend.valueAxis.axisRanges.create();
                maxRange.value = heatLegend.maxValue;
                maxRange.label.text = "A lot!";

                // Blank out internal heat legend value axis labels
                heatLegend.valueAxis.renderer.labels.template.adapter.add("text", function(labelText) {
                    return "";
                });

                // Configure series tooltip
                var polygonTemplate = polygonSeries.mapPolygons.template;
                polygonTemplate.tooltipText = "{name}: {value}";
                polygonTemplate.nonScalingStroke = true;
                polygonTemplate.strokeWidth = 0.5;

                // Create hover state and set alternative fill color
                var hs = polygonTemplate.states.create("hover");
                hs.properties.fill = chart.colors.getIndex(1).brighten(-0.5);

            });

        };

    }); // end am4core.ready()
</script>

<div id="chartdiv"></div>
<span id="chartdiv2"></span>

</body>
</html>

<!--[{:id=>"UA-05", :value=>7479}, {:id=>"UA-07", :value=>9727}, {:id=>"UA-09", :value=>3863}, {:id=>"UA-12", :value=>906}, {:id=>"UA-14", :value=>2298}, {:id=>"UA-18", :value=>9972}, {:id=>"UA-21", :value=>6664}, {:id=>"UA-23", :value=>948}, {:id=>"UA-26", :value=>7283}, {:id=>"UA-30", :value=>9972}, {:id=>"UA-32", :value=>4342}, {:id=>"UA-35", :value=>9902}, {:id=>"UA-40", :value=>6998}, {:id=>"UA-43", :value=>3451}, {:id=>"UA-46", :value=>5561}, {:id=>"UA-48", :value=>7600}, {:id=>"UA-51", :value=>4521}, {:id=>"UA-53", :value=>3077}, {:id=>"UA-56", :value=>4800}, {:id=>"UA-59", :value=>6872}, {:id=>"UA-61", :value=>5735}, {:id=>"UA-63", :value=>5331}, {:id=>"UA-65", :value=>6116}, {:id=>"UA-68", :value=>4559}, {:id=>"UA-71", :value=>6860}, {:id=>"UA-74", :value=>4354}, {:id=>"UA-77", :value=>635}]-->